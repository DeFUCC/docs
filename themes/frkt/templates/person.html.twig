{% extends 'partials/item-page.html.twig' %}


{% set main_id = 'person' %}

{% set options = { items: {'@root.descendants':''}, filter:{ visible: true }, 'order': {'by': 'modified', 'dir': 'asc'}} %}
{% set authorOf = page.collection('authorOf') %}
{% set doerOf = page.collection('doerOf') %}
{% set all_pages = page.collection(options) %}

{% for a_page in all_pages %}
  {% set people = a_page.header.people %}
  {% if people and people|count > 0 %}
    {% for person in people %}
      {% if person.alias == page.url %}
        {% if person.role == 'author' %}
          {% do authorOf.addPage(a_page) %}
        {% endif %}
        {% if person.role == 'doer' %}
          {% do doerOf.addPage(a_page) %}
        {% endif %}
      {% endif %}
    {% endfor %}
  {% endif %}
{% endfor %}

{% block lists %}
<footer class="listers">

{% include 'partials/lister.html.twig' with {
type: 'design',
title: 'THEME_FRUKT.AUTHOR',
collect: authorOf } %}

{% include 'partials/lister.html.twig' with {
type: 'project',
title: 'THEME_FRUKT.DOER',
collect: doerOf } %}

</footer>
{% endblock %}
